<html>
  <head>
    <title>Demo of HeyGraph: Canvas-based Network Graph diagramming tool</title>
    <link rel="stylesheet" type="text/css" href="css/css-reset.css" media="all" />
    <link rel="stylesheet" type="text/css" href="css/main.css" media="all" />
  </head>
  <body>
    <div class="content">
      <canvas id="myCanvas" width="1024" height="600">Fallback content, in case the browser does not support Canvas.</canvas>
      <h1>Demo of HeyGraph: Canvas-based Network Graph diagramming tool</h1>
      <p>This is a demo of HeyGraph, a Javascript and canvas based tool for visualing network graphs.  Currently only a force directed layout is
  available.  Additionally the visual appearance is limited to the white dots on a blue background demonstrated above. The graph displayed has been generated
at random.  Refresh the page to see another random graph visualised.  Please view this page in <a href="http://www.google.com/chrome" title="Google Chrome">Google Chrome</a> for the best performance.</p>
      <p>Below is the JSON that describes the Javascript used to initialise the HeyGraph component.</p>
      <pre></pre>
    </div>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js" type="text/javascript"></script>
    <script src="js/hey-graph.js" type="text/javascript"></script>
    <script src="js/json2.js" type="text/javascript"></script>
    <script type="text/javascript">
$(function() {
  var canvas = $("canvas").get(0);
  if (canvas && canvas.getContext) {
    var context = canvas.getContext('2d');
    if (context) {
  
      var graphData = createRandomGraph();
      $("pre").text(JSON.stringify(graphData, null, 1));
      var gLGraph = new HeyGraph(canvas, context, graphData);
    }
  }
});

function createRandomGraph() {
  var spikiness = Math.max(0, (Math.floor(Math.random() * 15)) - 10);
  var graphData = {};
  graphData.nodes = [];

  var nodeCount = Math.floor(Math.random() * 50) + 1;

  for(var nodeIndex = 0; nodeIndex < nodeCount; nodeIndex ++) {
    var newNode = {};
    newNode.graphId = "id" + nodeIndex;
    graphData.nodes.push(newNode);
  }

  graphData.edges = [];

  for(var nodeIndexA in graphData.nodes) {
    var nodeA = graphData.nodes[nodeIndexA];

    for(var nodeIndexB in graphData.nodes) {
      var nodeB = graphData.nodes[nodeIndexB];

      if(Math.floor(Math.random() * nodeCount) < (nodeIndexB * spikiness)) {
        var edge = {};
        edge.nodeAId = nodeA.graphId;
        edge.nodeBId = nodeB.graphId;
        
        graphData.edges.push(edge);

        if(spikiness > 0) {
          break;
        }
      }
    }
  }

  var graphs = HeyGraph.GraphUtils.normalizeGraph(graphData);

  graphData = HeyGraph.CollectionUtils.reduce(graphs, function(graphA, graphB) {
    if(graphA.nodes.length >= graphB.nodes.length) {
      return graphA;
    } else {
      return graphB;
    }
  });

  if(graphData.nodes.length < 4) {
    return createRandomGraph();
  } else {
    return graphData;
  }
};

function rgb2Hex(red, green, blue) {
  var decColor = red + 256 * green + 65536 * blue;
  return decColor.toString(16);
}

    </script>
  </body>
</html>
